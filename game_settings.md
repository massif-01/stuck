# 产品需求文档 (PRD) - 项目代号：Stuck

## 1. 产品概述
这是一款极简主义的、基于 iOS 平台的挂机观察类游戏。用户不参与直接互动，而是作为一个观察者，注视着屏幕内一个拥有独特灵魂（性格）的火柴人在纯色背景下进行随机活动。

*   **核心体验：** 陪伴感、盲盒感、生命唯一性。
*   **设计原则：** 极简（无UI、无声音）、拟真触感。

## 2. 视觉与交互规范
*   **屏幕方向：** 竖屏 (Portrait)。
*   **背景视觉：** 纯色（十六进制色值推荐：#FFF9E1，鹅黄色）。
*   **角色形象：** 
    *   风格：极简火柴人（偏矮胖型，增加可爱感与笨拙感）。
    *   动画：需要平滑的骨骼动画或逐帧动画，支持动作（如：太极、瑜伽、空气投篮等）。
*   **UI 界面：** 
    *   **首屏：** 仅显示背景和小人。
    *   **设置/菜单：** 隐藏式。建议通过“三指长按”或“摇一摇”调出极简菜单（仅包含 iCloud 同步状态和成就查看入口）。
*   **触觉反馈 (Haptic Feedback)：**
    *   完全取消音频输出。
    *   **核心反馈逻辑：** 调用 iOS `UIImpactFeedbackGenerator` 线性马达。
    *   **触发场景：** 
        *   轻度（Light）：走路脚落地、散步。
        *   中度（Medium）：翻跟头着地、劈叉瞬间。
        *   重度（Heavy）：撞墙、摔倒、空气投篮落地。
        *   特殊（Rigid）：连续撞墙时的急促反馈。

## 3. 核心机制：生命与性格系统
### 3.1 初始生成
*   用户首次进入游戏，系统从后台性格库中**随机抽取**一种性格赋予小人。
*   该性格通过 **iCloud** 进行全球唯一标识绑定。

### 3.2 性格分类（示例）
*   **悠闲型：** 动作频率慢，更倾向于做瑜伽、散步、发呆。
*   **狂躁型：** 动作剧烈，频繁撞墙、翻跟头，停不下来。
*   **低落型：** 动作幅度小，倾向于蹲下画圈、长久静止、用步子丈量土地。
*   **开心型：** 频繁跳舞、翻跟头、空气投篮。
*   **无聊型：** 在屏幕边缘反复徘徊、尝试各种奇怪动作。

### 3.3 死亡机制
*   **生命唯一：** 小人的性格档案存储在 App 沙盒与 iCloud 中。
*   **卸载即死亡：** 如果用户卸载 App，iCloud 对应档案将标记为“已结束”。
*   **重生：** 重新安装 App 后，系统视为一个全新的生命，再次随机分配一个性格，不可找回前世性格。

## 4. 行为驱动逻辑
小人的行为由**“状态机”**驱动，受三个维度共同影响：

1.  **基础概率池：** 走路、停顿、撞墙。
2.  **性格修正：** 不同性格会极大改变特定动作的触发权重（详见下一份权重文档）。
3.  **现实时间影响：**
    *   **白昼 (08:00 - 22:00)：** 活跃度高，执行复杂动作概率大。
    *   **深夜 (22:00 - 08:00)：** 活跃度低，小人更倾向于睡觉、静坐或缓慢行走。

## 5. 系统功能需求
### 5.1 iCloud 集成
*   **功能：** 存储性格 ID、总陪伴时长、已触发动作记录。
*   **目的：** 确保即使不打开 App，进度也能云端保留；同时作为判定“生命唯一”的依据。

### 5.2 Game Center 成就系统
这是玩家唯一的“进度感”，分为两个维度：
*   **陪伴类成就：**
    *   《初次见面》（首次进入游戏）。
    *   《百日相伴》（累计运行时间达 100 天）。
    *   《不离不弃》（连续一个月每日开启观察）。
*   **见证类成就（收集向）：**
    *   《运动健将》（累计触发过所有运动类动作）。
    *   《墙壁的敌人》（见证小人撞墙 1000 次）。
    *   《孤独的舞者》（见证小人跳舞）。
    *   《神秘仪式》（见证极其罕见的无实物表演）。

## 6. 技术接口预留
*   **Widget 接口：** 程序员需在底层架构设计时，预留将小人当前状态（动画帧）同步至桌面小组件（iOS Home Screen Widget）的接口，以便后期版本更新。

#### 6.2 天气系统接入 (WeatherKit Integration)
*   **技术框架：** 调用 iOS 原生 `WeatherKit` 框架及 `CoreLocation` 地理位置服务。
*   **刷新频率：** 建议每 60 分钟更新一次本地天气缓存，以节省电量。
*   **获取维度：** 
    1.  `Condition` (天气状况：晴、雨、雪、阴、雷暴等)
    2.  `Temperature` (当前气温：用于判定小人是否“畏寒”)
    3.  `Wind Speed` (风速：用于判定小人是否“站不稳”)

#### 6.3 环境影响因子 (Environmental Modifiers)
天气将作为一个**“全局权重修正器”**，叠加在性格权重之上。

| 天气状况 | 小人行为逻辑修正 (Environmental Modifier) | 视觉/触觉额外反馈 |
| :--- | :--- | :--- |
| **晴天 (Sunny)** | 全体活跃度 +20%。[空气投篮]、[跳远] 概率提升。 | 无 |
| **雨天 (Rainy)** | 活跃度 -30%。[站立发呆]、[蹲下画圈] 概率提升。 | 增加轻微的、持续的频率震动（模拟雨声感） |
| **雪天 (Snowy)** | 动作变缓慢。[散步] 权重降低，增加 [缩成一团] 或 [搓手] 动作。 | 走路时的线性马达反馈变得更“钝” |
| **雷暴 (Storm)** | 触发 [惊吓跳起]、[快速奔跑] 或 [抱头蹲下] 的概率极高。 | 配合闪电频率，触发一次强力瞬时震动 |
| **大风 (Windy)** | 增加 [倾斜行走] 动作，小人会向风向相反侧倾斜。 | 间歇性的、不规则的轻微震动 |
| **极冷/极热** | 极端气温下，小人会频繁 [擦汗] 或 [哈气]，[睡觉] 概率增加。 | 无 |

---

### 7. 给程序员的逻辑实现建议 (Dev Notes)

1.  **权限处理：** 
    *   在首次启动时请求 `Location` 权限（仅在使用期间）。
    *   如果用户拒绝提供位置，天气系统自动降级为“随机天气周期”或“默认晴天”，不影响核心运行。
2.  **权重叠加算法：** 
    *   计算公式更新：`最终动作概率 = (性格权重 + 天气修正权重) * 时间系数`。
    *   例如：如果是“雨天”，则将所有性格的 [画圈圈] 权重统一临时增加 50 点。
3.  **UI 表现：** 
    *   背景鹅黄色不建议改变（保持视觉纯净），但可以在天气变化时，通过背景颜色的**微调**（如雨天时鹅黄变暗一点，晴天变亮一点）来暗示环境变化。
