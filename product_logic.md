### 《stuck》产品逻辑与权重系统 (最终定稿版)

#### 一、 能源感应：电量二元逻辑 (Battery States)
不再设置复杂的百分比阶梯，仅保留两种生存状态。

| 状态 (State) | 判定条件 | 视觉与行为逻辑 | 线性马达 (Haptics) |
| :--- | :--- | :--- | :--- |
| **正常电量 (Normal)** | > 20% | 遵循 MBTI 原始权重：移动速度标准，线条为纯黑色 (#000000)。 | 提供完整的、具有性格特征的震动反馈。 |
| **低电量 (Low Power)** | ≤ 20% | **节能模式**：移动速度降低 60%，线条变为浅灰色 (#D3D3D3)，增加“坐下”和“原地喘息”的权重。 | 震动强度大幅衰减，仅保留核心动作的微弱触感。 |

*注：若处于“充电中”状态，无论百分比多少，均视为“正常电量”并获得 10% 的速度加成。*

---

#### 二、 性格演变：环境漂移系统 (Personality Drift)
火柴人的性格并非静态，它会吸收所在城市的“气候气息”。

1.  **基础层：** 初始 MBTI 性格决定基础行为权重。
2.  **演变层：** 系统每 24 小时记录一次当天的主要天气。
3.  **计算公式：** `当前行为权重 = 基础权重 + (7日天气累计修正值)`。
    *   **多雨/阴冷环境：** 逐渐增加 `I (内向)` 和 `P (随性)` 的权重。火柴人会变得更爱发呆，路径更圆滑。
    *   **晴朗/炎热环境：** 逐渐增加 `E (外向)` 和 `J (秩序)` 的权重。火柴人会更频繁地横跨屏幕，路径更直。
4.  **持久化：** 这种漂移是缓慢的（每天修正值不超过 1%），并存储在 iCloud 中。

---

#### 三、 核心交互：截屏无字日记 (Screenshot Diary)
这是玩家记录火柴人生命的唯一方式。系统监听截屏动作，并生成一张特定的分享图存入相册。

**1. 截屏视觉构成：**
*   **背景：** 纯净的鹅黄色 (#FFF9E5)。
*   **主体：** 当前动作中的火柴人。
*   **外框 (The Frame)：** 一个极简的黑色细线边框（距离屏幕边缘约 20pt）。
*   **生命标记：** 在外框的右下角，标注该生命存活的总时长。
    *   *格式示例：* `128h` (代表该小人自安装起已存在 128 小时)。

**2. 触发反馈：**
*   监听到截屏瞬间，屏幕闪烁一次，并触发一个模拟相机快门的 **[Impact Haptic]**。

---

#### 四、 16 型人格行为权重细化表 (核心算法)

开发者需根据此表为 `GKStateMachine`（状态机）赋值。

| MBTI 类型 | 核心移动方式 (Path) | 停顿频率 (Idle) | 特殊动作 (Special) | 震动风格 (Haptic Style) |
| :--- | :--- | :--- | :--- | :--- |
| **INTJ** | 绝对直线/90度转弯 | 中 | 边缘巡逻 | Sharp (利落) |
| **INTP** | 缓慢漂移/突然停止 | 极高 | 原地画圈 | Soft (柔和) |
| **ENTJ** | 高速长距离位移 | 低 | 猛烈撞墙 | Heavy (重感) |
| **ENTP** | 中轴线左右横跳 | 中 | 快速折返 | Double Tap (双击) |
| **INFJ** | 沿屏幕边缘滑行 | 高 | 仰望天空 | Pulse (脉冲) |
| **INFP** | 螺旋形/圆弧曲线 | 极高 | 蹲下缩成一团 | Ethereal (空灵) |
| **ENFJ** | 屏幕中心打转 | 低 | 挥手/跳跃 | Success (节奏) |
| **ENFP** | 全屏无规则乱跑 | 极低 | 倒立/翻滚 | Burst (爆发) |
| **ISTJ** | 固定的水平往返 | 中 | 打伞(雨天) | Rigid (生硬) |
| **ISFJ** | 小范围局部踱步 | 高 | 贴墙站立 | Warm (温润) |
| **ESTJ** | 快速对角线穿梭 | 低 | 矩形巡航 | Thud (沉闷) |
| **ESFJ** | 顺时针绕边行走 | 中 | 频繁变换方向 | Cyclic (循环) |
| **ISTP** | 爆发式位移+长静止 | 极高 | 瞬间冲刺 | Impact (冲击) |
| **ISFP** | 随意的S型曲线 | 中 | 接雨滴/雪花 | Fluid (流畅) |
| **ESTP** | 极速奔跑/反复撞墙 | 极低 | 疯狂旋转 | Violent (剧烈) |
| **ESFP** | 屏幕上半部跳动 | 低 | 舞蹈动作 | Sparkling (细碎) |

---

#### 五、 开发者技术实现指南 (Technical Requirements)

1.  **生存时长计时器 (Lifespan Counter)：**
    *   使用 `UserDefaults` 记录 App 首次安装/启动的时间戳。
    *   `当前时长 = (当前时间戳 - 初始时间戳) / 3600`，取整数。
    *   该值仅在截屏生成的图片上显示，游戏内无 UI 显示。

2.  **天气接入 (WeatherKit)：**
    *   每小时静默获取一次 `WeatherCondition`。
    *   重点映射：`isRainy`, `isSnowy`, `windSpeed`。

3.  **iCloud 存储：**
    *   存储字段：`Personality_ID` (MBTI类型), `Created_At` (出生时间), `Weather_Drift_Matrix` (偏移矩阵)。
    *   *卸载逻辑：* 卸载 App 会导致本地数据抹除，重新安装后通过 iCloud 恢复之前的寿命和性格；若用户手动删除 iCloud 数据，则火柴人“重生”。

4.  **视觉渲染：**
    *   火柴人由 6 段线段（躯干、四肢、头）组成，严禁使用序列帧动画，必须使用基于物理规律的 **程序化动画 (Procedural Animation)** 以保证不同电量下的速度切换平滑。
